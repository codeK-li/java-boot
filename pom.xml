<?xml version="1.0" encoding="UTF-8"?>
<project xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns="http://maven.apache.org/POM/4.0.0"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">

  <parent>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-parent</artifactId>
    <version>2.1.7.RELEASE</version>
  </parent>

  <modelVersion>4.0.0</modelVersion>

  <groupId>com.github.javaboot</groupId>
  <artifactId>parent</artifactId>
  <packaging>pom</packaging>
  <version>${revision}</version>

  <scm>
    <url>https://github.com/codeK-li/java-boot.git</url>
  </scm>

  <url>https://github.com/codeK-li/java-boot</url>

  <developers>
    <developer>
      <id>codeK-li</id>
      <name>李伟超</name>
      <email>codek_mk@163.com</email>
    </developer>
  </developers>

  <properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
    <java.version>1.8</java.version>
    <revision>2.1-SNAPSHOT</revision>

    <junit.jupiter.version>5.3.1</junit.jupiter.version>
    <junit.vintage.version>5.3.1</junit.vintage.version>
    <kotlin.version>1.3.21</kotlin.version>
    <!--<kotlin.version>1.2.71</kotlin.version>-->
    <mockk.version>1.8.9</mockk.version>
    <!-- JD -->
    <jd.security.configsec.version>1.0.3-SNAPSHOT</jd.security.configsec.version>
    <jd.jsf.version>1.6.9</jd.jsf.version>
    <jd.ump.version>4.0.5</jd.ump.version>
    <jim.cli.version>1.4.5-SNAPSHOT</jim.cli.version>

    <!-- Plugin -->
    <jacoco.maven.plugin.version>0.8.2</jacoco.maven.plugin.version>
    <maven.surefire.plugin.version>2.22.1</maven.surefire.plugin.version>
    <maven.pmd.plugin.version>3.8</maven.pmd.plugin.version>
    <maven.p3c.pmd.plugin.version>1.3.5</maven.p3c.pmd.plugin.version>
    <findbugs.maven.plugin.version>3.0.5</findbugs.maven.plugin.version>
    <maven.checkstyle.plugin.version>3.0.0</maven.checkstyle.plugin.version>
    <checkstyle.maven.version>8.13</checkstyle.maven.version>
    <maven.jxr.plugin.version>2.3</maven.jxr.plugin.version>
    <maven.site.plugin.version>3.7.1</maven.site.plugin.version>
    <maven.surefire.report.plugin.version>2.22.1</maven.surefire.report.plugin.version>
  </properties>

  <dependencyManagement>
    <dependencies>
      <!-- ONEJ -->
      <dependency>
        <groupId>com.github.javaboot</groupId>
        <artifactId>bundle</artifactId>
        <version>${revision}</version>
      </dependency>
      <dependency>
        <groupId>com.github.javaboot</groupId>
        <artifactId>webmvc-helper</artifactId>
        <version>${revision}</version>
      </dependency>
      <dependency>
        <groupId>com.github.javaboot</groupId>
        <artifactId>sso</artifactId>
        <version>${revision}</version>
      </dependency>
      <dependency>
        <groupId>com.github.javaboot</groupId>
        <artifactId>webmvc-sso</artifactId>
        <version>${revision}</version>
      </dependency>
      <dependency>
        <groupId>com.github.javaboot</groupId>
        <artifactId>webmvc-model</artifactId>
        <version>${revision}</version>
      </dependency>

      <!-- Kotlin -->
      <dependency>
        <groupId>org.jetbrains.kotlin</groupId>
        <artifactId>kotlin-stdlib-jdk8</artifactId>
        <version>${kotlin.version}</version>
      </dependency>
      <dependency>
        <groupId>org.jetbrains.kotlin</groupId>
        <artifactId>kotlin-test</artifactId>
        <version>${kotlin.version}</version>
      </dependency>
      <dependency>
        <groupId>org.jetbrains.kotlin</groupId>
        <artifactId>kotlin-stdlib-jdk8</artifactId>
        <version>${kotlin.version}</version>
      </dependency>

      <!-- Test -->
      <dependency>
        <groupId>org.junit.jupiter</groupId>
        <artifactId>junit-jupiter-api</artifactId>
        <version>${junit.jupiter.version}</version>
      </dependency>
      <dependency>
        <groupId>org.junit.jupiter</groupId>
        <artifactId>junit-jupiter-engine</artifactId>
        <version>${junit.jupiter.version}</version>
      </dependency>
      <dependency>
        <groupId>io.mockk</groupId>
        <artifactId>mockk</artifactId>
        <version>${mockk.version}</version>
      </dependency>

      <!-- JD -->
      <dependency>
        <groupId>com.jd.security.configsec</groupId>
        <artifactId>spring-configsec-sdk</artifactId>
        <version>${jd.security.configsec.version}</version>
      </dependency>
      <dependency>
        <groupId>com.jd</groupId>
        <artifactId>jsf</artifactId>
        <version>${jd.jsf.version}</version>
      </dependency>
      <dependency>
        <groupId>com.jd.jim.cli</groupId>
        <artifactId>jim-cli-jedis</artifactId>
        <version>${jim.cli.version}</version>
      </dependency>
      <dependency>
        <groupId>com.jd.jim.cli</groupId>
        <artifactId>jim-cli-api</artifactId>
        <version>${jim.cli.version}</version>
      </dependency>
    </dependencies>
  </dependencyManagement>

  <dependencies>
    <!--Spring Boot-->
    <dependency>
      <groupId>org.springframework.boot</groupId>
      <artifactId>spring-boot-starter</artifactId>
      <exclusions>
        <exclusion>
          <groupId>org.springframework.boot</groupId>
          <artifactId>spring-boot-starter-logging</artifactId>
        </exclusion>
      </exclusions>
    </dependency>
    <!--<dependency>-->
      <!--<groupId>org.springframework.boot</groupId>-->
      <!--<artifactId>spring-boot-starter-log4j2</artifactId>-->
    <!--</dependency>-->
    <dependency>
      <groupId>org.springframework.boot</groupId>
      <artifactId>spring-boot-starter-web</artifactId>
      <exclusions>
        <exclusion>
          <groupId>org.springframework.boot</groupId>
          <artifactId>spring-boot-starter-tomcat</artifactId>
        </exclusion>
      </exclusions>
    </dependency>

    <!--JD-->
    <dependency>
      <groupId>com.jd</groupId>
      <artifactId>jsf</artifactId>
    </dependency>

    <!-- Test -->
    <dependency>
      <groupId>org.jetbrains.kotlin</groupId>
      <artifactId>kotlin-stdlib-jdk8</artifactId>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>org.jetbrains.kotlin</groupId>
      <artifactId>kotlin-reflect</artifactId>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>org.springframework.boot</groupId>
      <artifactId>spring-boot-starter-test</artifactId>
      <scope>test</scope>
      <exclusions>
        <exclusion>
          <groupId>junit</groupId>
          <artifactId>junit</artifactId>
        </exclusion>
      </exclusions>
    </dependency>
    <dependency>
      <groupId>io.projectreactor</groupId>
      <artifactId>reactor-test</artifactId>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>org.junit.jupiter</groupId>
      <artifactId>junit-jupiter-api</artifactId>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>org.junit.jupiter</groupId>
      <artifactId>junit-jupiter-engine</artifactId>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>io.mockk</groupId>
      <artifactId>mockk</artifactId>
      <scope>test</scope>
    </dependency>
  </dependencies>

  <build>
    <plugins>
      <!--https://kotlinlang.org/docs/reference/using-maven.html-->
      <plugin>
        <artifactId>kotlin-maven-plugin</artifactId>
        <groupId>org.jetbrains.kotlin</groupId>
        <version>${kotlin.version}</version>
        <configuration>
          <args>
            <arg>-Xjsr305=strict</arg>
          </args>
          <compilerPlugins>
            <plugin>spring</plugin>
          </compilerPlugins>
          <jvmTarget>${java.version}</jvmTarget>
        </configuration>
        <executions>
          <execution>
            <id>test-compile</id>
            <phase>test-compile</phase>
            <goals>
              <goal>test-compile</goal>
            </goals>
            <configuration>
              <sourceDirs>
                <sourceDir>src/test/kotlin</sourceDir>
              </sourceDirs>
            </configuration>
          </execution>
        </executions>
        <dependencies>
          <dependency>
            <groupId>org.jetbrains.kotlin</groupId>
            <artifactId>kotlin-maven-allopen</artifactId>
            <version>${kotlin.version}</version>
          </dependency>
        </dependencies>
      </plugin>

      <!--https://maven.apache.org/surefire/maven-surefire-plugin-->
      <plugin>
        <artifactId>maven-surefire-plugin</artifactId>
        <version>${maven.surefire.plugin.version}</version>
      </plugin>

      <!--https://www.eclemma.org/jacoco/trunk/doc/maven.html-->
      <!--https://www.eclemma.org/jacoco/trunk/doc/check-mojo.html-->
      <plugin>
        <groupId>org.jacoco</groupId>
        <artifactId>jacoco-maven-plugin</artifactId>
        <version>${jacoco.maven.plugin.version}</version>
        <executions>
          <execution>
            <id>prepare-agent</id>
            <goals>
              <goal>prepare-agent</goal>
            </goals>
          </execution>
          <execution>
            <id>post-unit-test</id>
            <phase>test</phase>
            <goals>
              <goal>report</goal>
            </goals>
          </execution>
          <execution>
            <id>default-check</id>
            <goals>
              <goal>check</goal>
            </goals>
            <phase>verify</phase>
            <configuration>
              <rules>
                <rule implementation="org.jacoco.maven.RuleConfiguration">
                  <element>BUNDLE</element>
                  <limits>
                    <limit implementation="org.jacoco.report.check.Limit">
                      <counter>INSTRUCTION</counter>
                      <value>COVEREDRATIO</value>
                      <minimum>0.90</minimum>
                    </limit>
                  </limits>
                </rule>
              </rules>
            </configuration>
          </execution>
        </executions>
      </plugin>

      <!--https://www.mojohaus.org/flatten-maven-plugin-->
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>flatten-maven-plugin</artifactId>
        <inherited>true</inherited>
        <executions>
          <execution>
            <id>flatten</id>
            <phase>process-resources</phase>
            <goals>
              <goal>flatten</goal>
            </goals>
            <configuration>
              <updatePomFile>true</updatePomFile>
              <flattenMode>clean</flattenMode>
              <pomElements>
                <parent>expand</parent>
                <developers>expand</developers>
                <dependencyManagement>expand</dependencyManagement>
              </pomElements>
            </configuration>
          </execution>
        </executions>
      </plugin>

      <!--https://maven.apache.org/plugins/maven-source-plugin-->
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-source-plugin</artifactId>
        <version>3.0.1</version>
        <executions>
          <execution>
            <id>attach-sources</id>
            <phase>package</phase>
            <goals>
              <goal>jar-no-fork</goal>
            </goals>
          </execution>
        </executions>
      </plugin>

      <!--https://maven.apache.org/plugins/maven-site-plugin-->
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-site-plugin</artifactId>
        <version>${maven.site.plugin.version}</version>
        <dependencies>
          <dependency>
            <groupId>org.apache.maven.doxia</groupId>
            <artifactId>doxia-site-renderer</artifactId>
            <version>1.8.1</version>
          </dependency>
          <dependency>
            <groupId>commons-beanutils</groupId>
            <artifactId>commons-beanutils</artifactId>
            <version>1.9.3</version>
          </dependency>
          <dependency>
            <groupId>dom4j</groupId>
            <artifactId>dom4j</artifactId>
            <version>1.1</version>
          </dependency>
        </dependencies>
      </plugin>

      <!--定义在 reporting 是因为在 reporting 的 plugin 无法定义 dependencies-->
      <!--https://maven.apache.org/plugins/maven-pmd-plugin-->
      <!--https://github.com/alibaba/p3c/tree/master/p3c-pmd-->
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-pmd-plugin</artifactId>
        <version>${maven.pmd.plugin.version}</version>
        <configuration>
          <sourceEncoding>${project.build.sourceEncoding}</sourceEncoding>
          <targetJdk>${java.version}</targetJdk>
          <printFailingErrors>true</printFailingErrors>
          <rulesets>
            <ruleset>rulesets/java/ali-comment.xml</ruleset>
            <ruleset>rulesets/java/ali-concurrent.xml</ruleset>
            <ruleset>rulesets/java/ali-constant.xml</ruleset>
            <ruleset>rulesets/java/ali-exception.xml</ruleset>
            <ruleset>rulesets/java/ali-flowcontrol.xml</ruleset>
            <ruleset>rulesets/java/ali-naming.xml</ruleset>
            <ruleset>rulesets/java/ali-oop.xml</ruleset>
            <ruleset>rulesets/java/ali-orm.xml</ruleset>
            <ruleset>rulesets/java/ali-other.xml</ruleset>
            <ruleset>rulesets/java/ali-set.xml</ruleset>
          </rulesets>
          <includes>**/*.java</includes>
        </configuration>
        <executions>
          <execution>
            <id>pmd-check-verify</id>
            <phase>verify</phase>
            <goals>
              <goal>check</goal>
            </goals>
          </execution>
          <execution>
            <id>pmd-pmd-site</id>
            <phase>site</phase>
            <goals>
              <goal>pmd</goal>
            </goals>
          </execution>
        </executions>
        <dependencies>
          <dependency>
            <groupId>com.alibaba.p3c</groupId>
            <artifactId>p3c-pmd</artifactId>
            <version>${maven.p3c.pmd.plugin.version}</version>
          </dependency>
        </dependencies>
      </plugin>

      <!--https://maven.apache.org/plugins/maven-checkstyle-plugin/-->
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-checkstyle-plugin</artifactId>
        <version>${maven.checkstyle.plugin.version}</version>
        <configuration>
          <configLocation>doc/checkstyle/checkstyle-checker.xml</configLocation>
        </configuration>
        <executions>
          <execution>
            <phase>site</phase>
            <goals>
              <goal>checkstyle</goal>
            </goals>
          </execution>
        </executions>
        <dependencies>
          <dependency>
            <groupId>com.puppycrawl.tools</groupId>
            <artifactId>checkstyle</artifactId>
            <version>${checkstyle.maven.version}</version>
          </dependency>
        </dependencies>
      </plugin>
    </plugins>
  </build>

  <reporting>
    <plugins>
      <!--https://maven.apache.org/jxr/maven-jxr-plugin/-->
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-jxr-plugin</artifactId>
        <version>${maven.jxr.plugin.version}</version>
      </plugin>

      <!--http://maven.apache.org/surefire/maven-surefire-report-plugin-->
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-surefire-report-plugin</artifactId>
        <version>${maven.surefire.report.plugin.version}</version>
      </plugin>

      <!--https://gleclaire.github.io/findbugs-maven-plugin/-->
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>findbugs-maven-plugin</artifactId>
        <version>${findbugs.maven.plugin.version}</version>
        <configuration>
          <findbugsXmlOutput>true</findbugsXmlOutput>
          <xmlOutput>true</xmlOutput>
          <failOnError>false</failOnError>
        </configuration>
      </plugin>

      <!--https://www.eclemma.org/jacoco/trunk/doc/maven.html-->
      <plugin>
        <groupId>org.jacoco</groupId>
        <artifactId>jacoco-maven-plugin</artifactId>
        <version>${jacoco.maven.plugin.version}</version>
        <reportSets>
          <reportSet>
            <reports>
              <report>report</report>
            </reports>
          </reportSet>
        </reportSets>
      </plugin>
    </plugins>
  </reporting>

  <modules>
    <module>bundle</module>
    <module>webmvc-helper</module>
    <module>sso</module>
    <module>webmvc-sso</module>
    <module>webmvc-model</module>
    <module>framework</module>
  </modules>

  <distributionManagement>
    <repository>
      <id>jd-releases</id>
      <name>libs-releases</name>
      <url>http://artifactory.jd.com/libs-releases-local/</url>
    </repository>
    <snapshotRepository>
      <id>jd-snapshots</id>
      <name>libs-snapshots</name>
      <url>http://artifactory.jd.com/libs-snapshots-local/</url>
    </snapshotRepository>
  </distributionManagement>
</project>